(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{bjw9:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("HaE+"),r=i("o0o1"),s=i.n(r),a=i("lHlH"),o=i("JR+K"),u=i("Iq2B"),l=i("JX7q"),h=i("dI71"),d=i("98Cc"),m=i("dTJe"),c=i("2aL3");function f(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var g=function(e){function t(t,i){var n;return void 0===i&&(i={}),(n=e.call(this,t,i)||this).target=null,n._queryPending=!1,n._pollingPromise=null,Object.seal(Object(l.a)(n)),n}Object(h.a)(t,e),t.isSupported=function(e,t){void 0===t&&(t=[]);for(var i,n=Object(a.h)(e),r=Object(m.c)(e,c.a.TIMER_QUERY),s=n||r,o=f(t);!(i=o()).done;){switch(i.value){case"queries":s=s&&n;break;case"timers":s=s&&r;break;default:Object(u.a)(!1)}}return s};var i=t.prototype;return i.beginTimeElapsedQuery=function(){return this.begin(35007)},i.beginOcclusionQuery=function(e){var t=(void 0===e?{}:e).conservative,i=void 0!==t&&t;return this.begin(i?36202:35887)},i.beginTransformFeedbackQuery=function(){return this.begin(35976)},i.begin=function(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this},i.end=function(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this},i.isResultAvailable=function(){if(!this._queryPending)return!1;var e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e},i.isTimerDisjoint=function(){return this.gl2.getParameter(36795)},i.getResult=function(){return this.gl2.getQueryParameter(this.handle,34918)},i.getTimerMilliseconds=function(){return this.getResult()/1e6},i.createPoll=function(e){var t=this;if(void 0===e&&(e=Number.POSITIVE_INFINITY),this._pollingPromise)return this._pollingPromise;var i=0;return this._pollingPromise=new Promise((function(n,r){requestAnimationFrame((function s(){t.isResultAvailable()?(n(t.getResult()),t._pollingPromise=null):i++>e?(r("Timed out"),t._pollingPromise=null):requestAnimationFrame(s)}))})),this._pollingPromise},i._createHandle=function(){return t.isSupported(this.gl)?this.gl2.createQuery():null},i._deleteHandle=function(){this.gl2.deleteQuery(this.handle)},t}(d.a);function v(e){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}var _=i("mECX"),w=i("QenK"),b=Object(w.isBrowser)()&&"undefined"!=typeof document,P=0,y=function(){function e(e){void 0===e&&(e={});var t=e,i=t.onCreateContext,n=void 0===i?function(e){return Object(a.c)(e)}:i,r=t.onAddHTML,s=void 0===r?null:r,u=t.onInitialize,l=void 0===u?function(){}:u,h=t.onRender,d=void 0===h?function(){}:h,m=t.onFinalize,c=void 0===m?function(){}:m,f=t.onError,p=t.gl,g=void 0===p?null:p,v=t.glOptions,_=void 0===v?{}:v,w=t.debug,b=void 0!==w&&w,y=t.createFramebuffer,R=void 0!==y&&y,T=t.autoResizeViewport,F=void 0===T||T,x=t.autoResizeDrawingBuffer,D=void 0===x||x,z=t.stats,C=void 0===z?o.a.get("animation-loop-"+P++):z,L=e.useDevicePixels,A=void 0===L||L;"useDevicePixelRatio"in e&&(a.i.deprecated("useDevicePixelRatio","useDevicePixels")(),A=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:s,onInitialize:l,onRender:d,onFinalize:c,onError:f,gl:g,glOptions:_,debug:b,createFramebuffer:R},this.gl=g,this.needsRedraw=null,this.timeline=null,this.stats=C,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:F,autoResizeDrawingBuffer:D,useDevicePixels:A}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}var t=e.prototype;return t.delete=function(){this.stop(),this._setDisplay(null)},t.setNeedsRedraw=function(e){return Object(u.a)("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this},t.setProps=function(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this},t.start=function(e){var t=this;if(void 0===e&&(e={}),this._running)return this;this._running=!0;var i=this._getPageLoadPromise().then((function(){return!t._running||t._initialized?null:(t._createWebGLContext(e),t._createFramebuffer(),t._startEventHandling(),t._initializeCallbackData(),t._updateCallbackData(),t._resizeCanvasDrawingBuffer(),t._resizeViewport(),t._gpuTimeQuery=g.isSupported(t.gl,["timers"])?new g(t.gl):null,t._initialized=!0,t.onInitialize(t.animationProps))})).then((function(e){t._running&&(t._addCallbackData(e||{}),!1!==e&&t._startLoop())}));return this.props.onError&&i.catch(this.props.onError),this},t.redraw=function(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this},t.stop=function(){return this._running&&(this._finalizeCallbackData(),v(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this},t.attachTimeline=function(e){return this.timeline=e,this.timeline},t.detachTimeline=function(){this.timeline=null},t.waitForRender=function(){var e=this;return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((function(t){e._resolveNextFrame=t}))),this._nextFramePromise},t.toDataURL=function(){var e=Object(n.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setNeedsRedraw("toDataURL"),e.next=3,this.waitForRender();case 3:return e.abrupt("return",this.gl.canvas.toDataURL());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.isContextLost=function(){return this.gl.isContextLost()},t.onCreateContext=function(){var e;return(e=this.props).onCreateContext.apply(e,arguments)},t.onInitialize=function(){var e;return(e=this.props).onInitialize.apply(e,arguments)},t.onRender=function(){var e;return(e=this.props).onRender.apply(e,arguments)},t.onFinalize=function(){var e;return(e=this.props).onFinalize.apply(e,arguments)},t.getHTMLControlValue=function(e,t){void 0===t&&(t=1);var i=document.getElementById(e);return i?Number(i.value):t},t.setViewParameters=function(){return a.i.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this},t._startLoop=function(){var e=this;v(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame((function t(){e._running&&(e.redraw(),e._animationFrameId=e._requestAnimationFrame(t))}))},t._getPageLoadPromise=function(){return this._pageLoadPromise||(this._pageLoadPromise=b?new Promise((function(e,t){b&&"complete"===document.readyState?e(document):window.addEventListener("load",(function(){e(document)}))})):Promise.resolve({})),this._pageLoadPromise},t._setDisplay=function(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e},t._requestAnimationFrame=function(e){var t;this.display&&this.display.requestAnimationFrame(e)||(t=e,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60))},t._renderFrame=function(){var e;this.display?(e=this.display)._renderFrame.apply(e,arguments):this.onRender.apply(this,arguments)},t._clearNeedsRedraw=function(){this.needsRedraw=null},t._setupFrame=function(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()},t._initializeCallbackData=function(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}},t._updateCallbackData=function(){var e=this._getSizeAndAspect(),t=e.width,i=e.height,n=e.aspect;t===this.animationProps.width&&i===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=i,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen},t._finalizeCallbackData=function(){this.onFinalize(this.animationProps)},t._addCallbackData=function(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))},t._createWebGLContext=function(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Object(a.f)(this.props.gl,e):this.onCreateContext(e),!Object(a.g)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Object(a.k)(this.gl),this._createInfoDiv()},t._createInfoDiv=function(){if(this.gl.canvas&&this.props.onAddHTML){var e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";var t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);var i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}},t._getSizeAndAspect=function(){var e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight,i=1,n=this.gl.canvas;return n&&n.clientHeight?i=n.clientWidth/n.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}},t._resizeViewport=function(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)},t._resizeCanvasDrawingBuffer=function(){this.autoResizeDrawingBuffer&&Object(a.l)(this.gl,{useDevicePixels:this.useDevicePixels})},t._createFramebuffer=function(){this.props.createFramebuffer&&(this.framebuffer=new _.a(this.gl))},t._resizeFramebuffer=function(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})},t._beginTimers=function(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()},t._endTimers=function(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()},t._startEventHandling=function(){var e=this.gl.canvas;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))},t._onMousemove=function(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]},t._onMouseleave=function(e){this.animationProps._mousePosition=null},e}()}}]);