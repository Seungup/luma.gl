(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{bjw9:function(e,i,t){"use strict";t.d(i,"a",(function(){return P}));var n=t("HaE+"),r=t("o0o1"),s=t.n(r),a=t("lHlH"),o=t("JR+K"),u=t("Iq2B"),l=t("JX7q"),h=t("dI71"),m=t("98Cc"),c=t("dTJe"),d=t("2aL3");function f(e,i){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,i){if(!e)return;if("string"==typeof e)return p(e,i);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return p(e,i)}(e))||i&&e&&"number"==typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,i){(null==i||i>e.length)&&(i=e.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=e[t];return n}var g=function(e){function i(i,t){var n;return void 0===t&&(t={}),(n=e.call(this,i,t)||this).target=null,n._queryPending=!1,n._pollingPromise=null,Object.seal(Object(l.a)(n)),n}Object(h.a)(i,e),i.isSupported=function(e,i){void 0===i&&(i=[]);for(var t,n=Object(a.h)(e),r=Object(c.c)(e,d.a.TIMER_QUERY),s=n||r,o=f(i);!(t=o()).done;){switch(t.value){case"queries":s=s&&n;break;case"timers":s=s&&r;break;default:Object(u.a)(!1)}}return s};var t=i.prototype;return t.beginTimeElapsedQuery=function(){return this.begin(35007)},t.beginOcclusionQuery=function(e){var i=(void 0===e?{}:e).conservative,t=void 0!==i&&i;return this.begin(t?36202:35887)},t.beginTransformFeedbackQuery=function(){return this.begin(35976)},t.begin=function(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this},t.end=function(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this},t.isResultAvailable=function(){if(!this._queryPending)return!1;var e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e},t.isTimerDisjoint=function(){return this.gl2.getParameter(36795)},t.getResult=function(){return this.gl2.getQueryParameter(this.handle,34918)},t.getTimerMilliseconds=function(){return this.getResult()/1e6},t.createPoll=function(e){var i=this;if(void 0===e&&(e=Number.POSITIVE_INFINITY),this._pollingPromise)return this._pollingPromise;var t=0;return this._pollingPromise=new Promise((function(n,r){requestAnimationFrame((function s(){i.isResultAvailable()?(n(i.getResult()),i._pollingPromise=null):t++>e?(r("Timed out"),i._pollingPromise=null):requestAnimationFrame(s)}))})),this._pollingPromise},t._createHandle=function(){return i.isSupported(this.gl)?this.gl2.createQuery():null},t._deleteHandle=function(){this.gl2.deleteQuery(this.handle)},i}(m.a);var _=t("mECX"),v=t("QenK"),w=Object(v.isBrowser)()&&"undefined"!=typeof document,b=0,P=function(){function e(e){void 0===e&&(e={});var i=e,t=i.onCreateContext,n=void 0===t?function(e){return Object(a.c)(e)}:t,r=i.onAddHTML,s=void 0===r?null:r,u=i.onInitialize,l=void 0===u?function(){}:u,h=i.onRender,m=void 0===h?function(){}:h,c=i.onFinalize,d=void 0===c?function(){}:c,f=i.onError,p=i.gl,g=void 0===p?null:p,_=i.glOptions,v=void 0===_?{}:_,w=i.debug,P=void 0!==w&&w,y=i.createFramebuffer,F=void 0!==y&&y,R=i.autoResizeViewport,T=void 0===R||R,x=i.autoResizeDrawingBuffer,D=void 0===x||x,z=i.stats,C=void 0===z?o.a.get("animation-loop-"+b++):z,A=e.useDevicePixels,L=void 0===A||A;"useDevicePixelRatio"in e&&(a.i.deprecated("useDevicePixelRatio","useDevicePixels")(),L=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:s,onInitialize:l,onRender:m,onFinalize:d,onError:f,gl:g,glOptions:v,debug:P,createFramebuffer:F},this.gl=g,this.needsRedraw=null,this.timeline=null,this.stats=C,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:T,autoResizeDrawingBuffer:D,useDevicePixels:L}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}var i=e.prototype;return i.delete=function(){this.stop(),this._setDisplay(null)},i.setNeedsRedraw=function(e){return Object(u.a)("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this},i.setProps=function(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this},i.start=function(e){var i=this;if(void 0===e&&(e={}),this._running)return this;this._running=!0;var t=this._getPageLoadPromise().then((function(){return!i._running||i._initialized?null:(i._createWebGLContext(e),i._createFramebuffer(),i._startEventHandling(),i._initializeCallbackData(),i._updateCallbackData(),i._resizeCanvasDrawingBuffer(),i._resizeViewport(),i._gpuTimeQuery=g.isSupported(i.gl,["timers"])?new g(i.gl):null,i._initialized=!0,i.onInitialize(i.animationProps))})).then((function(e){i._running&&(i._addCallbackData(e||{}),!1!==e&&i._startLoop())}));return this.props.onError&&t.catch(this.props.onError),this},i.redraw=function(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this},i.stop=function(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this},i.attachTimeline=function(e){return this.timeline=e,this.timeline},i.detachTimeline=function(){this.timeline=null},i.waitForRender=function(){var e=this;return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((function(i){e._resolveNextFrame=i}))),this._nextFramePromise},i.toDataURL=function(){var e=Object(n.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setNeedsRedraw("toDataURL"),e.next=3,this.waitForRender();case 3:return e.abrupt("return",this.gl.canvas.toDataURL());case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.isContextLost=function(){return this.gl.isContextLost()},i.onCreateContext=function(){var e;return(e=this.props).onCreateContext.apply(e,arguments)},i.onInitialize=function(){var e;return(e=this.props).onInitialize.apply(e,arguments)},i.onRender=function(){var e;return(e=this.props).onRender.apply(e,arguments)},i.onFinalize=function(){var e;return(e=this.props).onFinalize.apply(e,arguments)},i.getHTMLControlValue=function(e,i){void 0===i&&(i=1);var t=document.getElementById(e);return t?Number(t.value):i},i.setViewParameters=function(){return a.i.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this},i._startLoop=function(){var e=this;this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame((function i(){e._running&&(e.redraw(),e._animationFrameId=e._requestAnimationFrame(i))}))},i._getPageLoadPromise=function(){return this._pageLoadPromise||(this._pageLoadPromise=w?new Promise((function(e,i){w&&"complete"===document.readyState?e(document):window.addEventListener("load",(function(){e(document)}))})):Promise.resolve({})),this._pageLoadPromise},i._setDisplay=function(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e},i._cancelAnimationFrame=function(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):(i=e,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(i):clearTimeout(i));var i},i._requestAnimationFrame=function(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):(i=e,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(i):setTimeout(i,1e3/60));var i},i._renderFrame=function(){var e;this.display?(e=this.display)._renderFrame.apply(e,arguments):this.onRender.apply(this,arguments)},i._clearNeedsRedraw=function(){this.needsRedraw=null},i._setupFrame=function(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()},i._initializeCallbackData=function(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}},i._updateCallbackData=function(){var e=this._getSizeAndAspect(),i=e.width,t=e.height,n=e.aspect;i===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=i,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen},i._finalizeCallbackData=function(){this.onFinalize(this.animationProps)},i._addCallbackData=function(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))},i._createWebGLContext=function(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Object(a.f)(this.props.gl,e):this.onCreateContext(e),!Object(a.g)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Object(a.k)(this.gl),this._createInfoDiv()},i._createInfoDiv=function(){if(this.gl.canvas&&this.props.onAddHTML){var e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";var i=document.createElement("div");i.style.position="absolute",i.style.left="10px",i.style.bottom="10px",i.style.width="300px",i.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(i);var t=this.props.onAddHTML(i);t&&(i.innerHTML=t)}},i._getSizeAndAspect=function(){var e=this.gl.drawingBufferWidth,i=this.gl.drawingBufferHeight,t=1,n=this.gl.canvas;return n&&n.clientHeight?t=n.clientWidth/n.clientHeight:e>0&&i>0&&(t=e/i),{width:e,height:i,aspect:t}},i._resizeViewport=function(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)},i._resizeCanvasDrawingBuffer=function(){this.autoResizeDrawingBuffer&&Object(a.l)(this.gl,{useDevicePixels:this.useDevicePixels})},i._createFramebuffer=function(){this.props.createFramebuffer&&(this.framebuffer=new _.a(this.gl))},i._resizeFramebuffer=function(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})},i._beginTimers=function(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()},i._endTimers=function(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()},i._startEventHandling=function(){var e=this.gl.canvas;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))},i._onMousemove=function(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]},i._onMouseleave=function(e){this.animationProps._mousePosition=null},e}()}}]);