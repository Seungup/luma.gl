(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{tNJd:function(n,e,o){"use strict";o.r(e),o.d(e,"default",(function(){return p}));var t=o("dI71"),i=o("q1tI"),r=o.n(i),a=o("z0FI"),s=(o("PF2M"),o("IZzc"),o("ebS/")),f=o("tdDb"),c=o("4mOd"),_=o("IA9D"),l=o("Q+fr"),u=o("u/XE"),d=Object(u.a)();new Uint8Array([255,0,0,255]),new l.a({id:"transform"}).enable();function h(n){[n.offsetX,n.offsetY]}function v(n){null}var A=function(n){function e(e){var o,t=e.device,i=e.width,r=e.height;if(o=n.call(this)||this,"webgl2"!==t.info.type)throw new Error("THIS DEMO REQUIRES WEBGL 2, BUT YOUR BROWSER DOESN'T SUPPORT IT");t.canvasContext.canvas.addEventListener("mousemove",h),t.canvasContext.canvas.addEventListener("mouseleave",v);for(var a=new Float32Array([.015,0,-.01,.01,-.01,-.01]),s=new Float32Array(2e3),l=new Float32Array(1e3),u=new Float32Array(3e3),A=new Uint8ClampedArray(2e3),p=0;p<1e3;++p){s[2*p]=2*d()-1,s[2*p+1]=2*d()-1,l[p]=2*d()*Math.PI,d()>.5?(u[3*p+1]=1,u[3*p+2]=1):(u[3*p]=1,u[3*p+2]=1),A[2*p]=Math.floor(p/255),A[2*p+1]=p-255*A[2*p]}return o.positionBuffer=new f.c(t,a),o.colorBuffer=new f.c(t,u),o.offsetBuffer=new f.c(t,s),o.rotationBuffer=new f.c(t,l),o.pickingColorBuffer=new f.c(t,A),o.renderModel=new f.e(t,{id:"RenderModel",vs:"#version 300 es\n#define OFFSET_LOCATION 0\n#define ROTATION_LOCATION 1\n#define POSITION_LOCATION 2\n#define COLOR_LOCATION 3\nprecision highp float;\nprecision highp int;\nlayout(location = POSITION_LOCATION) in vec2 a_position;\nlayout(location = ROTATION_LOCATION) in float a_rotation;\nlayout(location = OFFSET_LOCATION) in vec2 a_offset;\nlayout(location = COLOR_LOCATION) in vec3 a_color;\nin vec2 instancePickingColors;\nout vec3 v_color;\nvoid main()\n{\n    v_color = a_color;\n\n    float cos_r = cos(a_rotation);\n    float sin_r = sin(a_rotation);\n    mat2 rot = mat2(\n        cos_r, sin_r,\n        -sin_r, cos_r\n    );\n    gl_Position = vec4(rot * a_position + a_offset, 0.0, 1.0);\n    picking_setPickingColor(vec3(0., instancePickingColors));\n}\n",fs:"#version 300 es\n#define ALPHA 0.9\nprecision highp float;\nprecision highp int;\nin vec3 v_color;\nout vec4 color;\nvoid main()\n{\n    color = vec4(v_color * ALPHA, ALPHA);\n    color = picking_filterColor(color);\n}\n",drawMode:_.a.TRIANGLE_FAN,vertexCount:3,isInstanced:!0,instanceCount:1e3,attributes:{a_position:o.positionBuffer,a_color:[o.colorBuffer,{divisor:1}],a_offset:[o.offsetBuffer,{divisor:1}],a_rotation:[o.rotationBuffer,{divisor:1}],instancePickingColors:[o.pickingColorBuffer,{divisor:1}]},modules:[c.a]}),o.transform=new f.m(t,{vs:"#version 300 es\n#define OFFSET_LOCATION 0\n#define ROTATION_LOCATION 1\n\n#define M_2PI 6.28318530718\n\n// We simulate the wandering of agents using transform feedback in this vertex shader\n// The simulation goes like this:\n// Assume there's a circle in front of the agent whose radius is WANDER_CIRCLE_R\n// the origin of which has a offset to the agent's pivot point, which is WANDER_CIRCLE_OFFSET\n// Each frame we pick a random point on this circle\n// And the agent moves MOVE_DELTA toward this target point\n// We also record the rotation facing this target point, so it will be the base rotation\n// for our next frame, which means the WANDER_CIRCLE_OFFSET vector will be on this direction\n// Thus we fake a smooth wandering behavior\n\n#define MAP_HALF_LENGTH 1.01\n#define WANDER_CIRCLE_R 0.01\n#define WANDER_CIRCLE_OFFSET 0.04\n#define MOVE_DELTA 0.001\nprecision highp float;\nprecision highp int;\nuniform float u_time;\nlayout(location = OFFSET_LOCATION) in vec2 a_offset;\nlayout(location = ROTATION_LOCATION) in float a_rotation;\nout vec2 v_offset;\nout float v_rotation;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    float theta = M_2PI * rand(vec2(u_time, a_rotation + a_offset.x + a_offset.y));\n    float cos_r = cos(a_rotation);\n    float sin_r = sin(a_rotation);\n    mat2 rot = mat2(\n        cos_r, sin_r,\n        -sin_r, cos_r\n    );\n\n    vec2 p = WANDER_CIRCLE_R * vec2(cos(theta), sin(theta)) + vec2(WANDER_CIRCLE_OFFSET, 0.0);\n    vec2 move = normalize(rot * p);\n    v_rotation = atan(move.y, move.x);\n    v_offset = a_offset + MOVE_DELTA * move;\n\n    // wrapping at edges\n    v_offset = vec2 (\n        v_offset.x > MAP_HALF_LENGTH ? - MAP_HALF_LENGTH :\n          ( v_offset.x < - MAP_HALF_LENGTH ? MAP_HALF_LENGTH : v_offset.x ) ,\n        v_offset.y > MAP_HALF_LENGTH ? - MAP_HALF_LENGTH :\n          ( v_offset.y < - MAP_HALF_LENGTH ? MAP_HALF_LENGTH : v_offset.y )\n        );\n\n    gl_Position = vec4(v_offset, 0.0, 1.0);\n}\n",elementCount:1e3,sourceBuffers:{a_offset:o.offsetBuffer,a_rotation:o.rotationBuffer},feedbackMap:{a_offset:"v_offset",a_rotation:"v_rotation"}}),o.pickingFramebuffer=new f.f(t,{width:i,height:r}),o}Object(t.a)(e,n);var o=e.prototype;return o.onFinalize=function(){this.renderModel.delete(),this.transform.delete()},o.onRender=function(n){n.gl,n.width,n.height;var e=n.time;this.transform.run({uniforms:{u_time:e}}),this.transform.swap(),this.offsetBuffer=this.transform.getBuffer("v_offset"),this.rotationBuffer=this.transform.getBuffer("v_rotation"),this.offsetBuffer.setAccessor({divisor:1}),this.rotationBuffer.setAccessor({divisor:1}),this.renderModel.clear({color:[0,0,0,1],depth:!0}),this.renderModel.draw({attributes:{a_offset:this.offsetBuffer,a_rotation:this.rotationBuffer},parameters:{blend:!0,blendFunc:[_.a.SRC_ALPHA,_.a.ONE]}}),this.offsetBuffer.setAccessor({divisor:0}),this.rotationBuffer.setAccessor({divisor:0})},e}(s.a);A.info='\n<p>\n  Instanced triangles animated on the GPU using a luma.gl <code>Transform</code> object.\n\n  This is a port of an example from\n  <a href="https://github.com/WebGLSamples/WebGL2Samples/blob/master/samples/transform_feedback_instanced.html">\n    WebGL2Samples\n  </a>\n',"undefined"==typeof window||window.website||s.a.run(A);var p=function(n){function e(){return n.apply(this,arguments)||this}return Object(t.a)(e,n),e.prototype.render=function(){return r.a.createElement(a.a,{AnimationLoop:A,exampleConfig:this.props.pageContext.exampleConfig})},e}(r.a.Component)},"u/XE":function(n,e,o){"use strict";function t(){var n=1,e=1;return function(){return n=Math.sin(17.23*e),e=Math.cos(27.92*n),(o=1432.71*Math.abs(n*e))-Math.floor(o);var o}}o.d(e,"a",(function(){return t}));t()}}]);